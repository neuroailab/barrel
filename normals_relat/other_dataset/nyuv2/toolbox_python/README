I tried to translate from original matlab version to python version. Python is too slow for this purpose, so I stopped working on that. Meanwhile, for further translating, keep an eye for reshape, they have different behaviors
